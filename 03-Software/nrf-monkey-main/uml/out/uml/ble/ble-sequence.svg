<?plantuml 1.2026.1beta5?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="737px" preserveAspectRatio="none" style="width:802px;height:737px;background:#FFFFFF;" version="1.1" viewBox="0 0 802 737" width="802px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="542.2578" style="stroke:#000000;stroke-width:1.5;" width="775.144" x="10" y="170.9922"/><rect fill="none" height="110.5313" style="stroke:#000000;stroke-width:1.5;" width="614.522" x="30" y="195.125"/><rect fill="none" height="386.5938" style="stroke:#000000;stroke-width:1.5;" width="755.144" x="20" y="319.6563"/><rect fill="none" height="52.2656" style="stroke:#000000;stroke-width:1.5;" width="735.144" x="30" y="402.0547"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="APP" id="part1-lifeline"><g><title>BLE Handler</title><rect fill="#000000" fill-opacity="0.00000" height="677.6563" width="8" x="85.9126" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="89" x2="89" y1="52.5938" y2="730.25"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="S" id="part2-lifeline"><g><title>BLE Stack</title><rect fill="#000000" fill-opacity="0.00000" height="677.6563" width="8" x="364.0283" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="367.6836" x2="367.6836" y1="52.5938" y2="730.25"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="HW" id="part3-lifeline"><g><title>nRF54L15</title><rect fill="#000000" fill-opacity="0.00000" height="677.6563" width="8" x="588.481" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="592.4399" x2="592.4399" y1="52.5938" y2="730.25"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="APP" id="part1-head"><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99.8252" x="40" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.8252" x="47" y="24.9951">BLE Handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49.2598" x="65.2827" y="41.292">Thread</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="S" id="part2-head"><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.6895" x="302.6836" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.46" x="333.2983" y="24.9951">BLE Stack</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.6895" x="309.6836" y="41.292">(Host/Controller)</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="HW" id="part3-head"><rect fill="#E3E3E3" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84.082" x="550.4399" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70.082" x="557.4399" y="24.9951">nRF54L15</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.6484" x="572.6567" y="41.292">Radio</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="795.144" x="0" y="83.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="795.144" y1="83.1602" y2="83.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="795.144" y1="86.1602" y2="86.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="278.0625" x="258.5408" y="72.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="259.5366" x="264.5408" y="88.6606">Execution Phase (Operational loop)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#181818" points="356.0283,122.8594,366.0283,126.8594,356.0283,130.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="362.0283" y1="126.8594" y2="126.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.1694" x="96.9126" y="121.7935">bt_le_adv_start(adv_param, ad, sd)</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg2"><polygon fill="#181818" points="580.481,151.9922,590.481,155.9922,580.481,159.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.0283" x2="586.481" y1="155.9922" y2="155.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.4526" x="375.0283" y="150.9263">Tx adv packets (Ch 37, 38, 39)</text></g><path d="M10,170.9922 L86.624,170.9922 L86.624,178.125 L76.624,188.125 L10,188.125 L10,170.9922" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="542.2578" style="stroke:#000000;stroke-width:1.5;" width="775.144" x="10" y="170.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="25" y="184.0591">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="144.4824" x="101.624" y="183.2026">[while (system_active)]</text><path d="M30,195.125 L94.4429,195.125 L94.4429,202.2578 L84.4429,212.2578 L30,212.2578 L30,195.125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="110.5313" style="stroke:#000000;stroke-width:1.5;" width="614.522" x="30" y="195.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="45" y="208.1919">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157.9854" x="109.4429" y="207.3354">[Advertise data changed]</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg3"><polygon fill="#181818" points="356.0283,232.3906,366.0283,236.3906,356.0283,240.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="362.0283" y1="236.3906" y2="236.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5898" x="96.9126" y="231.3247">bt_le_adv_stop()</text></g><path d="M373,217.2578 L373,242.2578 L614,242.2578 L614,227.2578 L604,217.2578 L373,217.2578" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M604,217.2578 L604,227.2578 L614,227.2578 L604,217.2578" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.4097" x="379" y="234.3247">Restart advertising with new data</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg5"><polygon fill="#181818" points="356.0283,264.5234,366.0283,268.5234,356.0283,272.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="362.0283" y1="268.5234" y2="268.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.1694" x="96.9126" y="263.4575">bt_le_adv_start(adv_param, ad, sd)</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg6"><polygon fill="#181818" points="580.481,293.6563,590.481,297.6563,580.481,301.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.0283" x2="586.481" y1="297.6563" y2="297.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.4526" x="375.0283" y="292.5903">Tx adv packets (Ch 37, 38, 39)</text></g><path d="M20,319.6563 L84.4429,319.6563 L84.4429,326.7891 L74.4429,336.7891 L20,336.7891 L20,319.6563" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="386.5938" style="stroke:#000000;stroke-width:1.5;" width="755.144" x="20" y="319.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="332.7231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="185.9688" x="99.4429" y="331.8667">[Proximity detection enabled]</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg7"><polygon fill="#181818" points="356.0283,353.9219,366.0283,357.9219,356.0283,361.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="362.0283" y1="357.9219" y2="357.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.1157" x="96.9126" y="352.856">bt_le_scan_start(scan_param, scan_cb)</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg8"><polygon fill="#181818" points="580.481,383.0547,590.481,387.0547,580.481,391.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.0283" x2="586.481" y1="387.0547" y2="387.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.3457" x="375.0283" y="381.9888">Open rx window</text></g><path d="M30,402.0547 L106.624,402.0547 L106.624,409.1875 L96.624,419.1875 L30,419.1875 L30,402.0547" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="52.2656" style="stroke:#000000;stroke-width:1.5;" width="735.144" x="30" y="402.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="45" y="415.1216">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="124.2119" x="121.624" y="414.2651">[for each discovery]</text><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg9"><line style="stroke:#181818;stroke-width:1;" x1="90.9126" x2="100.9126" y1="443.3203" y2="439.3203"/><line style="stroke:#181818;stroke-width:1;" x1="90.9126" x2="100.9126" y1="443.3203" y2="447.3203"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="89.9126" x2="591.481" y1="443.3203" y2="443.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.145" x="106.9126" y="438.2544">device_found(addr, rssi, adv_data)</text></g><path d="M597,424.1875 L597,449.1875 L749,449.1875 L749,434.1875 L739,424.1875 L597,424.1875" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M739,424.1875 L739,434.1875 L749,434.1875 L739,424.1875" fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.6631" x="603" y="441.2544">Filter &amp; log to buffer</text><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg11"><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="131.9126" y1="482.4531" y2="482.4531"/><line style="stroke:#181818;stroke-width:1;" x1="131.9126" x2="131.9126" y1="482.4531" y2="495.4531"/><line style="stroke:#181818;stroke-width:1;" x1="90.9126" x2="131.9126" y1="495.4531" y2="495.4531"/><polygon fill="#181818" points="100.9126,491.4531,90.9126,495.4531,100.9126,499.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.4155" x="96.9126" y="477.3872">k_msleep(scan_window)</text></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg12"><polygon fill="#181818" points="356.0283,520.5859,366.0283,524.5859,356.0283,528.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="362.0283" y1="524.5859" y2="524.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.8042" x="96.9126" y="519.52">bt_le_scan_stop()</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg13"><polygon fill="#181818" points="580.481,549.7188,590.481,553.7188,580.481,557.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.0283" x2="586.481" y1="553.7188" y2="553.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.0376" x="375.0283" y="548.6528">Close rx window</text></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg14"><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="131.9126" y1="582.8516" y2="582.8516"/><line style="stroke:#181818;stroke-width:1;" x1="131.9126" x2="131.9126" y1="582.8516" y2="595.8516"/><line style="stroke:#181818;stroke-width:1;" x1="90.9126" x2="131.9126" y1="595.8516" y2="595.8516"/><polygon fill="#181818" points="100.9126,591.8516,90.9126,595.8516,100.9126,599.8516" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.5596" x="96.9126" y="577.7856">k_msleep(scan_interval - scan_window)</text></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg15"><polygon fill="#181818" points="356.0283,620.9844,366.0283,624.9844,356.0283,628.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="362.0283" y1="624.9844" y2="624.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5898" x="96.9126" y="619.9185">bt_le_adv_stop()</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg16"><polygon fill="#181818" points="580.481,650.1172,590.481,654.1172,580.481,658.1172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.0283" x2="586.481" y1="654.1172" y2="654.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.4775" x="375.0283" y="649.0513">Stop tx</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="20" x2="775.144" y1="663.1172" y2="663.1172"/><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg17"><line style="stroke:#181818;stroke-width:1;" x1="89.9126" x2="131.9126" y1="685.25" y2="685.25"/><line style="stroke:#181818;stroke-width:1;" x1="131.9126" x2="131.9126" y1="685.25" y2="698.25"/><line style="stroke:#181818;stroke-width:1;" x1="90.9126" x2="131.9126" y1="698.25" y2="698.25"/><polygon fill="#181818" points="100.9126,694.25,90.9126,698.25,100.9126,702.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.5522" x="96.9126" y="680.1841">k_msleep(2000)</text></g><?plantuml-src ZLDHQzim47xthpZwC6n8MBQkR2iaq8MMF1GMua9V0aQHBh68B1dfuYJ_VcUbTHAwDXNO7BhlTD_twHJMsjR2Yme2xGtotsj9cyeaeSjKpZfPUbSXaD_WIQOMSYrMcCTIZvA4NHbC4iwIbheMbk3gp-CzJ8HL1ltSFfKUXRe24U1kEdqBp8cFdDjquW9z7JjBtXakp695VewtiuUR7u_VRkPs9fHs4J9vJfBX4EvtA3UadOLfAG92-hT6BzeDOS0uLsSm72O9Ku3-27AuXGKL1WkXcY8GDqdRA8hiWL0z22fByXOxUMRmquutcoWVAK0wBk7wPm-kV_7tEqkIjWDiIyskf64V2Aj2ID8DPWdm4eRWJZN8MfYR4YH0bcmTgfXkrplCN9rc7SOwOjVrgYH6pJ3oRdd5SxLTmLPJ2HQtiSMbezyH_LhrQV4j6AtgX4wzs-bAqnuK4ez8UobenS9yf3P8OLyunV25L8pbud-i-88j-1rhjifjEq0Nn2jPEWyeP0bA1-dOg7sNRnSVrE-FHf7EBTDjjCHYwJPMiJFAzy27e5jhcg9rD3ihFhkD1sq8FNpXjYiW1ulDSec-mx_wSwBzq7DTLC4WrWVL1otPHPlEfk9eoTWu7g-tddpGKLkctV0RwSCfWpCdFpEQHn8v9u1sXx4m0I-m-3uO38upr7uAuzCHx2vZ_m40?></g></svg>